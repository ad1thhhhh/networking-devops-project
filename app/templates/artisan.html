{% extends "base.html" %}
{% block content %}

<div class="max-w-5xl mx-auto space-y-12">

<h1 class="text-4xl font-bold text-caramel tracking-wide">
Artisan Task Board
</h1>

<div id="taskContainer" class="space-y-6"></div>

</div>

<style>

/* Task Card Entry Animation */
.task-enter {
    opacity:0;
    transform:translateY(20px);
    animation:taskFade 0.5s ease forwards;
}

@keyframes taskFade {
    to {
        opacity:1;
        transform:translateY(0);
    }
}

/* Completed Task Style */
.task-completed {
    text-decoration: line-through;
    opacity:0.6;
    transition:all 0.3s ease;
}

/* High Priority Glow */
.high-priority {
    border:2px solid #facc15;
    box-shadow:0 0 12px rgba(250,204,21,0.4);
}

/* Ripple Effect */
.ripple {
    position:relative;
    overflow:hidden;
}

.ripple span {
    position:absolute;
    border-radius:50%;
    transform:scale(0);
    animation:rippleEffect 600ms linear;
    background:rgba(255,255,255,0.4);
}

@keyframes rippleEffect {
    to {
        transform:scale(4);
        opacity:0;
    }
}

</style>

<script>

/* Storage */
function getTasks(){
    return JSON.parse(localStorage.getItem("cafeTasks") || "[]");
}

function saveTasks(tasks){
    localStorage.setItem("cafeTasks", JSON.stringify(tasks));
}

/* Complete Task */
function completeTask(id){

    let tasks=getTasks();

    tasks=tasks.map(t=>{
        if(t.id===id){
            t.status="completed";
        }
        return t;
    });

    saveTasks(tasks);
    renderTasks();
}

/* Ripple Effect */
function createRipple(event,button){
    const circle=document.createElement("span");
    const diameter=Math.max(button.clientWidth,button.clientHeight);
    const radius=diameter/2;

    circle.style.width=circle.style.height=`${diameter}px`;
    circle.style.left=`${event.clientX-button.offsetLeft-radius}px`;
    circle.style.top=`${event.clientY-button.offsetTop-radius}px`;

    button.appendChild(circle);

    setTimeout(()=>circle.remove(),600);
}

/* Render Tasks */
function renderTasks(){

    const container=document.getElementById("taskContainer");
    container.innerHTML="";

    const tasks=getTasks().reverse();

    tasks.forEach((task,index)=>{

        const card=document.createElement("div");
        card.className="card p-6 flex justify-between items-center task-enter";

        if(task.priority==="high"){
            card.classList.add("high-priority");
        }

        const left=document.createElement("div");

        const title=document.createElement("div");
        title.textContent=task.name;
        title.className="text-lg font-semibold";

        if(task.status==="completed"){
            title.classList.add("task-completed");
        }

        left.appendChild(title);

        const right=document.createElement("div");

        if(task.status==="pending"){

            const btn=document.createElement("button");
            btn.textContent="Complete";
            btn.className="btn-coffee ripple";
            btn.onclick=(e)=>{
                createRipple(e,btn);
                setTimeout(()=>completeTask(task.id),200);
            };

            right.appendChild(btn);

        } else {

            const done=document.createElement("span");
            done.textContent="âœ” Completed";
            done.className="text-green-400 font-semibold";
            right.appendChild(done);
        }

        card.appendChild(left);
        card.appendChild(right);

        container.appendChild(card);
    });

}

/* Live Sync */
window.addEventListener("storage",renderTasks);
document.addEventListener("DOMContentLoaded",renderTasks);

</script>

{% endblock %}

